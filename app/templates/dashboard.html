{% extends "base.html" %}
{% block content %}
<h2 class="mt-4">Your To-Do List</h2>

<!-- Add Task Form -->
<div class="row">
    <div class="col-md-8">
        <form method="POST" action="{{ url_for('dashboard') }}">
            {{ form.hidden_tag() }}
            <div class="input-group mb-3">
                {{ form.task(class="form-control", placeholder="Enter new task") }}
                <button class="btn btn-success" type="submit">{{ form.submit.label.text }}</button>
            </div>
            {% for error in form.task.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </form>
    </div>
</div>

<!-- To-Do List -->
<table class="table table-striped">
    <thead>
        <tr>
            <th scope="col">Task</th>
            <th scope="col">Status</th>
            <th scope="col">Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for todo in todos %}
        <tr>
            <td>{{ todo.task }}</td>
            <td>
                {% if todo.completed %}
                    <span class="badge bg-success">Completed</span>
                {% else %}
                    <span class="badge bg-warning text-dark">Pending</span>
                {% endif %}
            </td>
            <td>
                <a href="{{ url_for('complete_todo', todo_id=todo.id) }}" class="btn btn-sm btn-primary">
                    {% if todo.completed %}Mark as Pending{% else %}Mark as Completed{% endif %}
                </a>
                <a href="{{ url_for('delete_todo', todo_id=todo.id) }}" class="btn btn-sm btn-danger"
                   onclick="return confirm('Are you sure you want to delete this task?');">Delete</a>
            </td>
        </tr>
        {% else %}
        <tr>
            <td colspan="3" class="text-center">No tasks added yet!</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
